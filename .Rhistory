View(garch_petro)
petro1 = data.frame(t  (data.frame(daamn(2, 4, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
garch_petro$X5 = as.numeric(garch_petro$X5) #%>% round(digits = 4)
garch_petro$X6 = as.numeric(garch_petro$X6) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'res ARCH (1,1)', 'res^2 ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(1, 5, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
garch_petro$X5 = as.numeric(garch_petro$X5) #%>% round(digits = 4)
garch_petro$X6 = as.numeric(garch_petro$X6) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'res ARCH (1,1)', 'res^2 ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(4, 1, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
garch_petro$X5 = as.numeric(garch_petro$X5) #%>% round(digits = 4)
garch_petro$X6 = as.numeric(garch_petro$X6) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'res ARCH (1,1)', 'res^2 ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(1, 4, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
garch_petro$X5 = as.numeric(garch_petro$X5) #%>% round(digits = 4)
garch_petro$X6 = as.numeric(garch_petro$X6) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'res ARCH (1,1)', 'res^2 ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(2, 3, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
garch_petro$X5 = as.numeric(garch_petro$X5) #%>% round(digits = 4)
garch_petro$X6 = as.numeric(garch_petro$X6) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'res ARCH (1,1)', 'res^2 ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(3, 1, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
garch_petro$X5 = as.numeric(garch_petro$X5) #%>% round(digits = 4)
garch_petro$X6 = as.numeric(garch_petro$X6) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'res ARCH (1,1)', 'res^2 ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(2, 1, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
garch_petro$X5 = as.numeric(garch_petro$X5) #%>% round(digits = 4)
garch_petro$X6 = as.numeric(garch_petro$X6) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'res ARCH (1,1)', 'res^2 ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(1, 3, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
garch_petro$X5 = as.numeric(garch_petro$X5) #%>% round(digits = 4)
garch_petro$X6 = as.numeric(garch_petro$X6) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'res ARCH (1,1)', 'res^2 ARCH (1,1)')
#сук ни один не подходит ...
list = c()
daamn = function(p, q, x){
for (g1 in 1:3){
for (g2 in 0:3){
for (type in c('sGARCH', 'eGARCH', 'gjrGARCH')) {
for (distribution in c('norm', 'std')){
spec = tryCatch(ugarchspec(variance.model = list(model = type, garchOrder = c(g1, g2)), mean.model = list(armaOrder = c(p, q), include.mean = TRUE), distribution.model = distribution), error = function(e) 'error')
garch.fit = tryCatch(ugarchfit(spec, x), error = function(e) 'error')
LogLik = tryCatch((garch.fit@fit$LLH %>% round(digits = 2)), error = function(e) 'error')
pvalue = tryCatch(Box.test(residuals(garch.fit), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
pvalue_sqv = tryCatch(Box.test(residuals(garch.fit)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
g_coeff = paste(g1, g2, sep = ',')
data = data.frame(values = c(type, distribution, g_coeff, LogLik, as.numeric(pvalue), as.numeric(pvalue_sqv)))
list = append(list, data.frame(data$values))
}
}
}
}
this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'p-value', 'p-value_sqv'), list)
print(this)
}
petro1 = data.frame(t  (data.frame(daamn(1, 3, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
garch_petro$X5 = as.numeric(garch_petro$X5) #%>% round(digits = 4)
garch_petro$X6 = as.numeric(garch_petro$X6) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'res ARCH (1,1)', 'res^2 ARCH (1,1)')
list = c()
daamn = function(p, q, x){
for (g1 in 1:3){
for (g2 in 0:3){
for (type in c('sGARCH', 'eGARCH', 'gjrGARCH')) {
for (distribution in c('norm', 'std')){
spec = tryCatch(ugarchspec(variance.model = list(model = type, garchOrder = c(g1, g2)), mean.model = list(armaOrder = c(p, q), include.mean = TRUE), distribution.model = distribution), error = function(e) 'error')
garch.fit = tryCatch(ugarchfit(spec, x), error = function(e) 'error')
LogLik = tryCatch((garch.fit@fit$LLH %>% round(digits = 2)), error = function(e) 'error')
pvalue = tryCatch(Box.test(residuals(garch.fit), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
#pvalue_sqv = tryCatch(Box.test(residuals(garch.fit)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
g_coeff = paste(g1, g2, sep = ',')
data = data.frame(values = c(type, distribution, g_coeff, LogLik, as.numeric(pvalue))#, as.numeric(pvalue_sqv)))
list = append(list, data.frame(data$values))
list = c()
daamn = function(p, q, x){
for (g1 in 1:3){
for (g2 in 0:3){
for (type in c('sGARCH', 'eGARCH', 'gjrGARCH')) {
for (distribution in c('norm', 'std')){
spec = tryCatch(ugarchspec(variance.model = list(model = type, garchOrder = c(g1, g2)), mean.model = list(armaOrder = c(p, q), include.mean = TRUE), distribution.model = distribution), error = function(e) 'error')
garch.fit = tryCatch(ugarchfit(spec, x), error = function(e) 'error')
#LogLik = tryCatch((garch.fit@fit$LLH %>% round(digits = 2)), error = function(e) 'error')
pvalue = tryCatch(Box.test(residuals(garch.fit), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
#pvalue_sqv = tryCatch(Box.test(residuals(garch.fit)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
g_coeff = paste(g1, g2, sep = ',')
data = data.frame(values = c(type, distribution, g_coeff, LogLik, as.numeric(pvalue)))#, as.numeric(pvalue_sqv)))
list = append(list, data.frame(data$values))
}
}
}
}
#this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'p-value', 'p-value_sqv'), list)
this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'p-value'), list)
print(this)
}
list = c()
daamn = function(p, q, x){
for (g1 in 1:3){
for (g2 in 0:3){
for (type in c('sGARCH', 'eGARCH', 'gjrGARCH')) {
for (distribution in c('norm', 'std')){
spec = tryCatch(ugarchspec(variance.model = list(model = type, garchOrder = c(g1, g2)), mean.model = list(armaOrder = c(p, q), include.mean = TRUE), distribution.model = distribution), error = function(e) 'error')
garch.fit = tryCatch(ugarchfit(spec, x), error = function(e) 'error')
#LogLik = tryCatch((garch.fit@fit$LLH %>% round(digits = 2)), error = function(e) 'error')
pvalue = tryCatch(Box.test(residuals(garch.fit), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
#pvalue_sqv = tryCatch(Box.test(residuals(garch.fit)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
g_coeff = paste(g1, g2, sep = ',')
#data = data.frame(values = c(type, distribution, g_coeff, LogLik, as.numeric(pvalue), as.numeric(pvalue_sqv)))
data = data.frame(values = c(type, distribution, g_coeff, as.numeric(pvalue)))
list = append(list, data.frame(data$values))
}
}
}
}
#this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'p-value', 'p-value_sqv'), list)
this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'p-value'), list)
print(this)
}
petro1 = data.frame(t  (data.frame(daamn(2, 5, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
garch_petro$X5 = as.numeric(garch_petro$X5) #%>% round(digits = 4)
petro1 = data.frame(t  (data.frame(daamn(5, 1, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(3, 3, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(2, 4, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(1, 5, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(4, 1, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(1, 4, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
#12
#52
#22
#21
#31
petro1 = data.frame(t  (data.frame(daamn(2, 3, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
#сук ни один не подходит ...
petro1 = data.frame(t  (data.frame(daamn(3, 1, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(2, 1, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(2, 2, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(5, 2, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
petro1 = data.frame(t  (data.frame(daamn(1, 2, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
daamn = function(p, q, x){
for (g1 in 1:1){
for (g2 in 0:1){
for (type in c('sGARCH', 'eGARCH', 'gjrGARCH')) {
for (distribution in c('norm', 'std')){
spec = tryCatch(ugarchspec(variance.model = list(model = type, garchOrder = c(g1, g2)), mean.model = list(armaOrder = c(p, q), include.mean = TRUE), distribution.model = distribution), error = function(e) 'error')
garch.fit = tryCatch(ugarchfit(spec, x), error = function(e) 'error')
#LogLik = tryCatch((garch.fit@fit$LLH %>% round(digits = 2)), error = function(e) 'error')
pvalue = tryCatch(Box.test(residuals(garch.fit), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
#pvalue_sqv = tryCatch(Box.test(residuals(garch.fit)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
g_coeff = paste(g1, g2, sep = ',')
#data = data.frame(values = c(type, distribution, g_coeff, LogLik, as.numeric(pvalue), as.numeric(pvalue_sqv)))
data = data.frame(values = c(type, distribution, g_coeff, as.numeric(pvalue)))
list = append(list, data.frame(data$values))
}
}
}
}
#this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'p-value', 'p-value_sqv'), list)
this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'p-value'), list)
print(this)
}
fuckme = function(p, q){
petro1 = data.frame(t  (data.frame(daamn(p, q, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
}
fuckme(1,2)
fuckme = function(p, q){
petro1 = data.frame(t  (data.frame(daamn(p, q, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
print(garch_petro)
}
fuckme(1,2)
#сук ни один не подходит ...
data.frame(fuckme(1,2))
data.frame(fuckme(1,2)) %>% cbind.data.frame(data.frame(fuckme(1,1)))
b = data.frame(fuckme(1,2))
b[3]
b[4]
b = data.frame(fuckme(1,2)) %>% cbind.data.frame(data.frame(fuckme(1,1))[4])
b = data.frame(fuckme(1,2)) %>% cbind(data.frame(fuckme(1,1))[4])
c = data.frame(fuckme(1,1))[4]
list = c()
daamn = function(p, q, x){
for (g1 in 1:1){
for (g2 in 0:0){
for (type in c('sGARCH', 'eGARCH', 'gjrGARCH')) {
for (distribution in c('norm', 'std')){
spec = tryCatch(ugarchspec(variance.model = list(model = type, garchOrder = c(g1, g2)), mean.model = list(armaOrder = c(p, q), include.mean = TRUE), distribution.model = distribution), error = function(e) 'error')
garch.fit = tryCatch(ugarchfit(spec, x), error = function(e) 'error')
#LogLik = tryCatch((garch.fit@fit$LLH %>% round(digits = 2)), error = function(e) 'error')
pvalue = tryCatch(Box.test(residuals(garch.fit), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
#pvalue_sqv = tryCatch(Box.test(residuals(garch.fit)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
g_coeff = paste(g1, g2, sep = ',')
#data = data.frame(values = c(type, distribution, g_coeff, LogLik, as.numeric(pvalue), as.numeric(pvalue_sqv)))
data = data.frame(values = c(type, distribution, g_coeff, as.numeric(pvalue)))
list = append(list, data.frame(data$values))
}
}
}
}
#this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'p-value', 'p-value_sqv'), list)
this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'p-value'), list)
print(this)
}
b = data.frame(fuckme(1,2))
c = data.frame(fuckme(1,1))[4]
c
b %>% cbind(c)
# POG
pog = read.csv('P7G.csv', sep = ',', dec = ',')
colnames(pog) = c('date', 'close', 'open', 'a', 'b', 'c', 'd')
pog = pog %>% dplyr::select(date, close, open)
#форматирование данных
pog$date = dmy(pog$date)
pog$open = as.numeric(gsub(",", ".", pog$open))
pog$close = as.numeric(gsub(",", ".", pog$close))
# AL
al = read.csv('A7L.csv', sep = ',', dec = ',')
colnames(al) = c('date', 'close', 'open', 'a', 'b', 'c', 'd')
al = al %>% dplyr::select(date, close, open)
#форматирование данных
al$date = dmy(al$date)
al$open = as.numeric(gsub(",", ".", al$open))
al$close = as.numeric(gsub(",", ".", al$close))
unified = left_join(pog, al, by = 'date') %>% na.omit()
dumy = ifelse(unified$date == '2022-03-02' | unified$date == '2014-09-12' | unified$date == '2014-05-12' | unified$date == '2014-03-06', 1, 0)
unified = unified %>% mutate(dumy = dumy)
pog = unified %>% select(date, close = close.x, open = open.x, dumy)
al = unified %>% select(date, close = close.y, open = open.y, dumy)
pog_d = diff(log(pog$close))
al_d = diff(log(al$close))
#небольшие приготовления
TABLE_pog_d = data.frame(date = unified$date[-1], log_dif = pog_d) %>% mutate(dumy = unified$dumy[-1])
TABLE_al_d = data.frame(date = unified$date[-1], log_dif = al_d) %>% mutate(dumy = unified$dumy[-1])
#достанем номера строк с датами объявления санкций
list = c()
for (i in 1:length(TABLE_pog_d$date)){
if(TABLE_pog_d$dumy[i] == '1'){
nums = data.frame(num = i)
list = append(list, nums)
}
}
nums = data.frame(n = t(data.frame(list))) %>% rownames_to_column()%>% select(-rowname)
# length(nums$n) - 4, значит приплюсуем 4 geom_vline... sory иначе не получилось
list = c()
daamn = function(p, q, x){
for (g1 in 0:5){
for (g2 in 0:5){
for (type in c('sGARCH', 'eGARCH', 'gjrGARCH')) {
for (distribution in c('norm', 'std')){
spec = tryCatch(ugarchspec(variance.model = list(model = type, garchOrder = c(g1, g2)), mean.model = list(armaOrder = c(p, q), include.mean = TRUE), distribution.model = distribution), error = function(e) 'error')
garch.fit = tryCatch(ugarchfit(spec, x), error = function(e) 'error')
#LogLik = tryCatch((garch.fit@fit$LLH %>% round(digits = 2)), error = function(e) 'error')
pvalue = tryCatch(Box.test(residuals(garch.fit), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
#pvalue_sqv = tryCatch(Box.test(residuals(garch.fit)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
g_coeff = paste(g1, g2, sep = ',')
#data = data.frame(values = c(type, distribution, g_coeff, LogLik, as.numeric(pvalue), as.numeric(pvalue_sqv)))
data = data.frame(values = c(type, distribution, g_coeff, as.numeric(pvalue)))
list = append(list, data.frame(data$values))
}
}
}
}
#this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'p-value', 'p-value_sqv'), list)
this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'p-value'), list)
print(this)
}
fuckme = function(p, q){
petro1 = data.frame(t  (data.frame(daamn(p, q, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'res ARCH (1,1)')
print(garch_petro)
}
a = data.frame(fuckme(1,2))
b = data.frame(fuckme(5,2))
View(a)
View(a)
c = data.frame(fuckme(2,2))
View(b)
d = data.frame(fuckme(1,3))
View(c)
e = data.frame(fuckme(2,1))
View(d)
f = data.frame(fuckme(3,1))
g = data.frame(fuckme(2,3))
h = data.frame(fuckme(1,4))
i = data.frame(fuckme(4,1))
j = data.frame(fuckme(1,5))
k = data.frame(fuckme(2,4))
list = c()
findin_ARCH = function(x){
for (p in 1:5){
for (q in 1:5){
ARMA = tryCatch(Arima(x, c(p, 0, q), include.constant = TRUE, method = c("CSS-ML")), error = function(e) NULL)
autocorr = tryCatch(Box.test(residuals(ARMA), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) NULL)
autocorr_sqv = tryCatch(Box.test(residuals(ARMA)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) NULL)
nums = paste(p, q, sep = ',')
data = data.frame(values = c(nums, as.numeric(ARMA$bic), as.numeric(ARMA$loglik), as.numeric(autocorr), as.numeric(autocorr_sqv)))
list = append(list, data.frame(data$values))
}
}
this = data.frame(parameters = c('p, q', 'BIC', 'LogLikelihood', 'p_value', 'p_value^2'), list)
h = rep('значения', 5*5)
names(this) = c('parameters', h)
print(this)
}
petro = findin_ARCH(TABLE_pog_d$log_dif)
petro = data.frame(t(petro)) %>% rownames_to_column() %>% select(-rowname) %>% column_to_rownames(var = 'X1')
petro = petro[-c(1), ]
colnames(petro) = c('BIC', 'LogLikelihood', 'p_value', 'p_value^2')
petro$p_value = as.numeric(petro$p_value)
petro = petro %>% dplyr::filter(p_value > 0.1) %>% rownames_to_column(var = 'ARCH_coeff')
View(petro)
amour = findin_ARCH(TABLE_al_d$log_dif)
amour = data.frame(t(amour)) %>% rownames_to_column() %>% select(-rowname) %>% column_to_rownames(var = 'X1')
amour = amour[-c(1), ]
colnames(amour) = c('BIC', 'LogLikelihood', 'p_value', 'p_value^2')
amour$p_value = as.numeric(amour$p_value)
amour = amour %>% dplyr::filter(p_value > 0.1) %>% rownames_to_column(var = 'ARCH_coeff')
View(amour)
# POG
pog = read.csv('P7G.csv', sep = ',', dec = ',')
colnames(pog) = c('date', 'close', 'open', 'a', 'b', 'c', 'd')
pog = pog %>% dplyr::select(date, close, open)
#форматирование данных
pog$date = dmy(pog$date)
pog$open = as.numeric(gsub(",", ".", pog$open))
pog$close = as.numeric(gsub(",", ".", pog$close))
# AL
al = read.csv('A7L.csv', sep = ',', dec = ',')
colnames(al) = c('date', 'close', 'open', 'a', 'b', 'c', 'd')
al = al %>% dplyr::select(date, close, open)
#форматирование данных
al$date = dmy(al$date)
al$open = as.numeric(gsub(",", ".", al$open))
al$close = as.numeric(gsub(",", ".", al$close))
unified = left_join(pog, al, by = 'date') %>% na.omit()
dumy = ifelse(unified$date == '2022-03-02' | unified$date == '2014-09-12' | unified$date == '2014-05-12' | unified$date == '2014-03-06', 1, 0)
unified = unified %>% mutate(dumy = dumy)
pog = unified %>% select(date, close = close.x, open = open.x, dumy)
al = unified %>% select(date, close = close.y, open = open.y, dumy)
pog_d = diff(log(pog$close))
al_d = diff(log(al$close))
#небольшие приготовления
TABLE_pog_d = data.frame(date = unified$date[-1], log_dif = pog_d) %>% mutate(dumy = unified$dumy[-1])
TABLE_al_d = data.frame(date = unified$date[-1], log_dif = al_d) %>% mutate(dumy = unified$dumy[-1])
#достанем номера строк с датами объявления санкций
list = c()
for (i in 1:length(TABLE_pog_d$date)){
if(TABLE_pog_d$dumy[i] == '1'){
nums = data.frame(num = i)
list = append(list, nums)
}
}
nums = data.frame(n = t(data.frame(list))) %>% rownames_to_column()%>% select(-rowname)
# length(nums$n) - 4, значит приплюсуем 4 geom_vline... sory иначе не получилось
list = c()
daamn = function(p, q, x){
for (g1 in 0:3){
for (g2 in 0:3){
for (type in c('sGARCH', 'eGARCH', 'gjrGARCH')) {
for (distribution in c('norm', 'std')){
spec = tryCatch(ugarchspec(variance.model = list(model = type, garchOrder = c(g1, g2)), mean.model = list(armaOrder = c(p, q), include.mean = TRUE), distribution.model = distribution), error = function(e) 'error')
garch.fit = tryCatch(ugarchfit(spec, x), error = function(e) 'error')
LogLik = tryCatch((garch.fit@fit$LLH %>% round(digits = 2)), error = function(e) 'error')
pvalue = tryCatch(Box.test(residuals(garch.fit), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
pvalue_sqv = tryCatch(Box.test(residuals(garch.fit)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
g_coeff = paste(g1, g2, sep = ',')
data = data.frame(values = c(type, distribution, g_coeff, LogLik, as.numeric(pvalue), as.numeric(pvalue_sqv)))
list = append(list, data.frame(data$values))
}
}
}
}
this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'p-value', 'p-value_sqv'), list)
print(this)
}
petro1 = data.frame(t  (data.frame(daamn(1, 2, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
list = c()
garchi <- function(g1, g2, p, q, x){
type = 'sGARCH'
for (distribution in c('norm', 'std')){
spec = tryCatch(ugarchspec(variance.model = list(model = type, garchOrder = c(g1, g2)), mean.model = list(armaOrder = c(p, q), include.mean = TRUE), distribution.model = distribution), error = function(e) 'error')
garch.fit = tryCatch(ugarchfit(spec, x), error = function(e) 'error')
LogLik = tryCatch((garch.fit@fit$LLH %>% round(digits = 2)), error = function(e) 'error')
pvalue = tryCatch(Box.test(residuals(garch.fit), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
pvalue_sqv = tryCatch(Box.test(residuals(garch.fit)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
g_coeff = paste(g1, g2, sep = ',')
data = data.frame(values = c(type, distribution, g_coeff, LogLik, as.numeric(pvalue), as.numeric(pvalue_sqv)))
list = append(list, data.frame(data$values))
}
this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'p-value', 'p-value_sqv'), list)
print(this)
}
garchi(0,1,1,2,TABLE_pog_d$log_dif)
garch_petro = garchi(0,1,1,2,TABLE_pog_d$log_dif)
View(garch_petro)
t(garch_petro)
data.frame(t(garch_petro))
garch_amour = garchi(1,1,1,1,TABLE_al_d$log_dif)
garch_amour = garchi(1,1,2,1,TABLE_al_d$log_dif)
list = c()
daamn = function(p, q, x){
for (g1 in 0:3){
for (g2 in 0:3){
for (type in c('sGARCH', 'eGARCH', 'gjrGARCH')) {
for (distribution in c('norm', 'std')){
spec = tryCatch(ugarchspec(variance.model = list(model = type, garchOrder = c(g1, g2)), mean.model = list(armaOrder = c(p, q), include.mean = TRUE), distribution.model = distribution), error = function(e) 'error')
garch.fit = tryCatch(ugarchfit(spec, x), error = function(e) 'error')
LogLik = tryCatch((garch.fit@fit$LLH %>% round(digits = 2)), error = function(e) 'error')
pvalue = tryCatch(Box.test(residuals(garch.fit), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
pvalue_sqv = tryCatch(Box.test(residuals(garch.fit)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
g_coeff = paste(g1, g2, sep = ',')
data = data.frame(values = c(type, distribution, g_coeff, LogLik, as.numeric(pvalue), as.numeric(pvalue_sqv)))
list = append(list, data.frame(data$values))
}
}
}
}
this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'p-value', 'p-value_sqv'), list)
print(this)
}
amour1 = data.frame(t  (data.frame(daamn(1, 1, TABLE_al_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_amour = data.frame(c(amour1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_amour$X4 = as.numeric(garch_amour$X4) #%>% round(digits = 4)
garch_amour$X5 = as.numeric(garch_amour$X5) #%>% round(digits = 4)
garch_amour$X6 = as.numeric(garch_amour$X6) #%>% round(digits = 4)
colnames(garch_amour) = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'res ARCH (1,1)', 'res^2 ARCH (1,1)')
View(garch_amour)
petro1 = data.frame(t  (data.frame(daamn(1, 2, TABLE_pog_d$log_dif)))  ) %>% rownames_to_column() %>% select(-rowname)
garch_petro = data.frame(c(petro1[-1, ])) %>% na.omit() %>% rownames_to_column() %>% select(-rowname)
garch_petro$X4 = as.numeric(garch_petro$X4) #%>% round(digits = 4)
garch_petro$X5 = as.numeric(garch_petro$X5) #%>% round(digits = 4)
garch_petro$X6 = as.numeric(garch_petro$X6) #%>% round(digits = 4)
colnames(garch_petro) = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'res ARCH (1,2)', 'res^2 ARCH (1,2)')
list = c()
garchi <- function(g1, g2, p, q, x){
type = 'sGARCH'
for (distribution in c('norm', 'std')){
spec = tryCatch(ugarchspec(variance.model = list(model = type, garchOrder = c(g1, g2)), mean.model = list(armaOrder = c(p, q), include.mean = TRUE), distribution.model = distribution), error = function(e) 'error')
garch.fit = tryCatch(ugarchfit(spec, x), error = function(e) 'error')
LogLik = tryCatch((garch.fit@fit$LLH %>% round(digits = 2)), error = function(e) 'error')
pvalue = tryCatch(Box.test(residuals(garch.fit), lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
pvalue_sqv = tryCatch(Box.test(residuals(garch.fit)^2, lag = log(length(x)), type = c("Ljung-Box"), fitdf = p+q)$p.value, error = function(e) 'error')
g_coeff = paste(g1, g2, sep = ',')
data = data.frame(values = c(type, distribution, g_coeff, LogLik, as.numeric(pvalue), as.numeric(pvalue_sqv)))
list = append(list, data.frame(data$values))
}
this = data.frame(parameters = c('type', 'distribution', 'g1,g2', 'LogLikelihood', 'p-value', 'p-value_sqv'), list)
print(this)
}
garch_petro = garchi(0,1,1,2,TABLE_pog_d$log_dif)
garch_amour = garchi(1,1,1,1,TABLE_al_d$log_dif)
garch_amour = garchi(1,0,1,1,TABLE_al_d$log_dif)
